"use strict";(self.webpackChunk_colibrijs_core=self.webpackChunk_colibrijs_core||[]).push([[5102],{"./components/element-add/element-add.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>ElementAdd});var _ant_design_icons__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/@ant-design/icons/es/icons/CloseOutlined.js"),_colibrijs_schema__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../schema/utils/get-default-values.ts"),_tanstack_react_query__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@tanstack/react-query/build/modern/useQuery.js"),antd__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/antd/es/modal/index.js"),antd__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../../node_modules/antd/es/form/index.js"),antd__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../../node_modules/antd/es/select/index.js"),antd__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../../node_modules/antd/es/input/index.js"),antd__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../../node_modules/antd/es/flex/index.js"),antd__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../../node_modules/antd/es/button/index.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_hooks_use_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./hooks/use-api/index.ts"),_hooks_use_schema__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./hooks/use-schema/index.ts");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ElementAdd(param){var _component_id,_component_id1,open=param.open,pageId=param.pageId,_param_testId=param.testId,testId=void 0===_param_testId?"element-add":_param_testId,onClose=param.onClose,onReady=param.onReady,api=(0,_hooks_use_api__WEBPACK_IMPORTED_MODULE_1__.gf)(),_useState=_sliced_to_array((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),component=_useState[0],setComponent=_useState[1],_useQuery=(0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_3__.I)({queryKey:[_hooks_use_api__WEBPACK_IMPORTED_MODULE_1__.bh],queryFn:function(){return api.components.get()}}),components=_useQuery.data,isLoading=_useQuery.isLoading,isSuccess=_useQuery.isSuccess,schema=(0,_hooks_use_schema__WEBPACK_IMPORTED_MODULE_2__.p)(component,{enabled:Boolean(component)}).data,componentsOptions=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){return isSuccess?components.map((function(component){return{label:React.createElement("span",{"data-testid":"component-option","data-value":component.id},component.name),value:component.id}})):[]}),[components,isSuccess]),changeComponentHandler=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(componentId){if(isSuccess){var _components_find,component=null!==(_components_find=components.find((function(component){return component.id===componentId})))&&void 0!==_components_find?_components_find:null;setComponent(component)}}),[components,isSuccess]),submitHandler=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){component&&schema&&onReady({component,pageId,props:(0,_colibrijs_schema__WEBPACK_IMPORTED_MODULE_4__.w)(schema)})}),[component,pageId,schema,onReady]);return React.createElement(antd__WEBPACK_IMPORTED_MODULE_5__.A,{footer:null,open,title:"Добавить элемент",onClose,onCancel:onClose,"data-testid":testId,closeIcon:React.createElement(_ant_design_icons__WEBPACK_IMPORTED_MODULE_6__.A,{"data-testid":"element-add__close-button"})},React.createElement(antd__WEBPACK_IMPORTED_MODULE_7__.A,{layout:"vertical",onFinish:submitHandler},React.createElement(antd__WEBPACK_IMPORTED_MODULE_7__.A.Item,{label:"Выберите компонент",required:!0},React.createElement(antd__WEBPACK_IMPORTED_MODULE_8__.A,{loading:isLoading,onChange:changeComponentHandler,options:componentsOptions,value:null!==(_component_id=null==component?void 0:component.id)&&void 0!==_component_id?_component_id:null,"data-testid":"element-add__select","data-value":String(null!==(_component_id1=null==component?void 0:component.id)&&void 0!==_component_id1?_component_id1:null)})),schema&&React.createElement(antd__WEBPACK_IMPORTED_MODULE_7__.A.Item,{label:"Пропсы"},React.createElement(antd__WEBPACK_IMPORTED_MODULE_9__.A.TextArea,{value:JSON.stringify((0,_colibrijs_schema__WEBPACK_IMPORTED_MODULE_4__.w)(schema),null,2),"data-testid":"element-add__props",autoSize:!0,disabled:!0})),React.createElement(antd__WEBPACK_IMPORTED_MODULE_10__.A,{justify:"end"},React.createElement(antd__WEBPACK_IMPORTED_MODULE_11__.Ay,{disabled:!component||!schema,htmlType:"submit",type:"primary","data-testid":"element-add__submit"},"Добавить"))))}ElementAdd.__docgenInfo={description:"",methods:[],displayName:"ElementAdd",props:{open:{required:!0,tsType:{name:"boolean"},description:""},pageId:{required:!0,tsType:{name:"string"},description:""},testId:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'element-add'",computed:!1}},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onReady:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: IElementConstructorOptions) => void",signature:{arguments:[{type:{name:"Omit",elements:[{name:"IElement"},{name:"literal",value:"'id'"}],raw:"Omit<IElement, 'id'>"},name:"options"}],return:{name:"void"}}},description:""}}}},"./hooks/use-api/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{bh:()=>COMPONENTS_KEY,YT:()=>ELEMENTS_KEY,PE:()=>PAGES_KEY,gf:()=>use_api.g});var COMPONENTS_KEY="components",ELEMENTS_KEY="elements",PAGES_KEY="pages",use_api=__webpack_require__("./hooks/use-api/use-api.ts")},"./hooks/use-schema/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>_use_schema__WEBPACK_IMPORTED_MODULE_0__.p});var _use_schema__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./hooks/use-schema/use-schema.ts")},"../schema/utils/get-default-values.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>getDefaultValues});var _get_properties_names__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../schema/utils/get-properties-names.ts");function getDefaultValues(schema){return getPropertiesValues(schema)}function getPropertiesValues(property){return(0,_get_properties_names__WEBPACK_IMPORTED_MODULE_0__.U)(property).reduce((function(obj,key){return"number"===property.properties[key].type&&(obj[key]=0),"string"===property.properties[key].type&&(obj[key]=""),"boolean"===property.properties[key].type&&(obj[key]=!1),"object"===property.properties[key].type&&(obj[key]=getPropertiesValues(property.properties[key])),obj}),{})}},"../schema/utils/get-properties-names.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function getPropertiesNames(property){return Object.keys(property.properties)}__webpack_require__.d(__webpack_exports__,{U:()=>getPropertiesNames})}}]);