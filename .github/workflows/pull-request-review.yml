on:
  pull_request_review:
    types: [submitted]
jobs:
  pull-request-review:
    runs-on: ubuntu-latest
    steps:
      - name: Send message to Telegram
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          GITHUB_ACTOR: ${{ github.actor }}
          PR_TITLE: ${{ github.event.pull_request.title }}
          PR_URL: ${{ github.event.pull_request.html_url }}
          REVIEW_STATE: ${{ github.event.review.state }}
          REVIEW_BODY: ${{ github.event.review.body }}
        run: |
          curl -s -X POST https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage \
          -d chat_id=${TELEGRAM_CHAT_ID} \
          -d text="Пользователь $GITHUB_ACTOR оставил ревью на Pull Request: *$PR_TITLE*.\n\nСтатус ревью: $REVIEW_STATE.\n\nКомментарий: $REVIEW_BODY.\n\nСсылка: $PR_URL" \
          -d parse_mode="Markdown
